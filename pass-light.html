<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤í… ë³¸ë¶€ - ë¬´ëŒ€ì¡°ëª…</title>
    <script src="auth.js"></script>
    <style>
        :root { --gold: #D4AF37; --navy: #0A192F; --glass: rgba(255, 255, 255, 0.08); }
        body { background: var(--navy); color: white; font-family: 'Apple SD Gothic Neo', sans-serif; margin: 0; display: none; }
        body.secure-visible { display: block; padding: 30px 20px; max-width: 450px; margin: auto; }

        /* ìƒë‹¨ í—¤ë” */
        .header { text-align: center; margin-bottom: 30px; border-bottom: 1px solid rgba(212,175,55,0.5); padding-bottom: 15px; }
        .header p { font-size: 0.8rem; opacity: 0.6; margin: 0 0 5px 0; }
        .header h1 { color: var(--gold); font-size: 1.8rem; margin: 0; letter-spacing: 1px; }

        /* ë·°(í™”ë©´) ì „í™˜ ì„¤ì • */
        .view-section { display: none; }
        .view-section.active { display: block; animation: fadeIn 0.4s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* 1. ë©”ì¸ ë©”ë‰´ ë²„íŠ¼ë“¤ */
        .menu-grid { display: grid; gap: 15px; }
        .menu-btn { background: var(--glass); border: 1px solid rgba(212,175,55,0.3); padding: 22px; border-radius: 12px; color: white; font-size: 1.1rem; font-weight: bold; display: flex; align-items: center; cursor: pointer; transition: 0.2s; }
        .menu-btn:active { background: var(--gold); color: var(--navy); }
        .menu-btn span { font-size: 1.3rem; margin-right: 15px; } /* ì•„ì´ì½˜ í¬ê¸° */
        .dummy-btn { opacity: 0.6; border-color: rgba(255,255,255,0.1); } /* ë¯¸ì‘ë™ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */

        /* 2. ê³µì§€ì‚¬í•­ í™”ë©´ */
        .notice-box { background: rgba(0,0,0,0.3); padding: 25px; border-radius: 15px; border-left: 4px solid var(--gold); line-height: 1.6; font-size: 0.95rem; word-break: keep-all; }

        /* 3. ì¶œì…ì¦(NFC) í™”ë©´ */
        .nfc-container { text-align: center; padding: 50px 20px; background: rgba(0,0,0,0.3); border-radius: 20px; border: 1px solid rgba(212,175,55,0.3); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .nfc-ring { width: 140px; height: 140px; border: 2px solid var(--gold); border-radius: 50%; margin: 0 auto 30px; display: flex; align-items: center; justify-content: center; position: relative; }
        .nfc-ring::after { content: ""; position: absolute; width: 100%; height: 100%; border: 2px solid var(--gold); border-radius: 50%; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 0.8; } 100% { transform: scale(1.4); opacity: 0; } }

        .status-text h2 { color: var(--gold); margin: 0 0 10px; font-size: 1.3rem; }
        .status-text p { margin: 0; color: #aaa; font-size: 0.95rem; }

        /* NFC ì¸ì¦ ì„±ê³µ ì‹œ ì´ˆë¡ìƒ‰ í…Œë§ˆ */
        body.access-granted { background: #064E3B; transition: background 0.5s; }
        body.access-granted .nfc-ring { border-color: #10B981; }
        body.access-granted .nfc-ring::after { border-color: #10B981; }
        body.access-granted .status-text h2 { color: #10B981; }

        /* í•˜ë‹¨ ëŒì•„ê°€ê¸° ë²„íŠ¼ */
        .back-btn { text-align: center; margin-top: 30px; color: rgba(255,255,255,0.6); text-decoration: underline; font-size: 0.9rem; cursor: pointer; padding: 10px; }
        .home-btn { display: block; text-align: center; margin-top: 40px; color: rgba(255,255,255,0.4); text-decoration: none; font-size: 0.85rem; }
    </style>
</head>
<body>
    <div class="header">
        <p>2026 í•œê¸°ì´ ë¶€ê²½ë°œëŒ€ì‹</p>
        <h1>ë¬´ëŒ€ì¡°ëª… íŒ€</h1> </div>

    <div id="view-menu" class="view-section active">
        <div class="menu-grid">
            <div class="menu-btn" onclick="showView('view-notice')"><span>ğŸ“¢</span> ê³µì§€ì‚¬í•­ í™•ì¸</div>
            <div class="menu-btn" onclick="openNfcView()"><span>ğŸªª</span> ìŠ¤ë§ˆíŠ¸ ì¶œì…ì¦</div>
            <div class="menu-btn dummy-btn" onclick="alert('í˜„ì¬ ê°œë°œ/ì¤€ë¹„ ì¤‘ì¸ ë©”ë‰´ì…ë‹ˆë‹¤.')"><span>âš™ï¸</span> ì¥ë¹„ ON/OFF ë‚´ì—­</div>
            <div class="menu-btn dummy-btn" onclick="alert('í˜„ì¬ ë“±ë¡ëœ ê¸°íƒ€ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.')"><span>ğŸ“</span> ê¸°íƒ€ ìë£Œ</div>
        </div>
        <a href="index.html" class="home-btn">â† ì „ì²´ ë©”ì¸ ë¡œë¹„ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>

    <div id="view-notice" class="view-section">
        <h2 style="color:var(--gold); margin-top:0;">íŒ€ í˜„ì¥ ì§€ì¹¨</h2>
        <div class="notice-box" id="subNoticeBox">ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>
        <div class="back-btn" onclick="showView('view-menu')">ëŒì•„ê°€ê¸°</div>
    </div>

    <div id="view-nfc" class="view-section">
        <div class="nfc-container" id="nfcZone">
            <div class="nfc-ring"><span style="font-size:3rem;">ğŸ“¡</span></div>
            <div class="status-text">
                <h2 id="accessTitle">ì¶œì…í‚¤ í™œì„±í™” ë¨</h2>
                <p id="accessDesc">ê¸°ê¸° ë’·ë©´ì„ ë¦¬ë”ê¸°ì— íƒœê·¸í•˜ì„¸ìš”.</p>
            </div>
        </div>
        <div class="back-btn" onclick="closeNfcView()">ëŒì•„ê°€ê¸°</div>
    </div>

    <script>
        // í™”ë©´ ì „í™˜ í•¨ìˆ˜
        function showView(viewId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
        }

        let nfcStarted = false;

        // ì¶œì…ì¦ ë©”ë‰´ í´ë¦­ ì‹œ NFC ê°€ë™
        async function openNfcView() {
            showView('view-nfc');

            if(nfcStarted) return; // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€

            if ('NDEFReader' in window) {
                try {
                    const reader = new NDEFReader();
                    await reader.scan();
                    nfcStarted = true;

                    reader.onreading = ({ serialNumber }) => {
                        document.body.classList.add('access-granted');
                        document.getElementById('accessTitle').innerText = "ì¶œì… ìŠ¹ì¸ ì™„ë£Œ";
                        document.getElementById('accessDesc').innerText = "ìŠ¹ì¸ ID: " + serialNumber;
                        if(navigator.vibrate) navigator.vibrate([200, 100, 200]);
                    };
                } catch (error) {
                    document.getElementById('accessDesc').innerText = "ìŠ¤ë§ˆíŠ¸í°ì˜ NFC ê¸°ëŠ¥ì„ ì¼œì£¼ì„¸ìš”.";
                }
            } else {
                document.getElementById('accessDesc').innerText = "(NFC ë¯¸ì§€ì› ê¸°ê¸° - í™”ë©´ì„ í„°ì¹˜í•´ ìˆ˜ë™ ìŠ¹ì¸)";
                document.getElementById('nfcZone').onclick = () => {
                    document.body.classList.add('access-granted');
                    document.getElementById('accessTitle').innerText = "ê´€ë¦¬ì ìˆ˜ë™ ìŠ¹ì¸";
                };
            }
        }

        // ì¶œì…ì¦ í™”ë©´ì—ì„œ ë¹ ì ¸ë‚˜ì˜¬ ë•Œ ì›ë˜ ìƒ‰ìƒê³¼ í…ìŠ¤íŠ¸ë¡œ ì´ˆê¸°í™”
        function closeNfcView() {
            document.body.classList.remove('access-granted');
            document.getElementById('accessTitle').innerText = "ì¶œì…í‚¤ í™œì„±í™” ë¨";

            if ('NDEFReader' in window) {
                document.getElementById('accessDesc').innerText = "ê¸°ê¸° ë’·ë©´ì„ ë¦¬ë”ê¸°ì— íƒœê·¸í•˜ì„¸ìš”.";
            } else {
                document.getElementById('accessDesc').innerText = "(NFC ë¯¸ì§€ì› ê¸°ê¸° - í™”ë©´ì„ í„°ì¹˜í•´ ìˆ˜ë™ ìŠ¹ì¸)";
            }

            showView('view-menu'); // ë©”ë‰´ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
        }
    </script>
</body>
</html>